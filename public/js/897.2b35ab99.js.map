{"version":3,"file":"js/897.2b35ab99.js","mappings":"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","sources":["webpack://shanotes-ui/./src/components/notes/Notes.vue","webpack://shanotes-ui/./src/components/notes/MarkdownViewer.vue","webpack://shanotes-ui/./src/components/notes/MarkdownViewer.vue?5299","webpack://shanotes-ui/./src/components/notes/PathTree.vue","webpack://shanotes-ui/./src/api/notes.js","webpack://shanotes-ui/./src/components/notes/PathTree.vue?6044","webpack://shanotes-ui/./src/components/notes/Notes.vue?0aaf"],"sourcesContent":["<template>\r\n  <div id=\"main\">\r\n    <PathTree @click_path=\"handleClickPath\" />\r\n\r\n    <mavon-editor v-loading=\"loading\" v-if=\"cur_path && cur_path.link_type!=1\" id=\"md-editor\" v-model=\"markdown_content\"\r\n      @save=\"saveFile\" :defaultOpen=\"'preview'\" :subfield=\"false\" :toolbars=\"markdown_options\" :navigation=\"true\">\r\n    </mavon-editor>\r\n\r\n  </div>\r\n</template>\r\n<script>\r\nimport MarkdownViewer from './MarkdownViewer.vue'\r\nimport PathTree from './PathTree.vue'\r\nimport { read_link, update_link } from '../../api/notes';\r\nexport default {\r\n  components: { PathTree, MarkdownViewer },\r\n  data() {\r\n    return {\r\n      markdown_options: {\r\n        navigation: true,\r\n        undo: true, // 上一步\r\n        redo: true, // 下一步\r\n        trash: true, // 清空\r\n        save: true, // 保存（触发events中的save事件）\r\n        subfield: true,\r\n        preview: true,\r\n      },\r\n      markdown_content: '',\r\n      cur_path: '',\r\n      raw_content: '',\r\n      loading: false,\r\n    }\r\n  },\r\n  computed: {\r\n    updated() {\r\n      return this.raw_content != this.markdown_content;\r\n    }\r\n  },\r\n  methods: {\r\n    async saveFile() {\r\n      this.loading = true;\r\n      let path_id = this.cur_path.path_id;\r\n      let res = await update_link(path_id, this.markdown_content);\r\n      this.loading = false;\r\n      if (res.meta.status != 200)\r\n        return alert(\"保存失败\");\r\n      this.raw_content = this.markdown_content;\r\n      return alert(\"保存成功\");\r\n    },\r\n    async handleClickPath(val) {\r\n      if (!val || val.path_id == 0 || val.link_type == 1)\r\n        return;\r\n      if (this.updated)\r\n        await this.saveFile();\r\n      this.cur_path = val;\r\n      console.log(val);\r\n      // 读取链接\r\n\r\n      this.loading = true;\r\n      let res = await read_link(val.path_id);\r\n      this.loading = false;\r\n\r\n      if (res.meta.status != 200)\r\n        return alert('请求数据失败');\r\n      res = res.content;\r\n      this.markdown_content = res.content == null ? '' : res.content;\r\n      this.raw_content = this.markdown_content;\r\n\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped lang=\"less\">\r\n#main {\r\n  display: flex;\r\n  flex-direction: row;\r\n  width: 100%;\r\n  #md-editor {\r\n    min-height: 100%;\r\n    min-width: 80%;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <mavon-editor id=\"md-editor\" v-model=\"markdown_content\" :defaultOpen=\"'preview'\" :subfield=\"false\"\r\n    :toolbars=\"markdown_options\" :navigation=\"true\">\r\n  </mavon-editor>\r\n</template>\r\n<script>\r\nexport default {\r\n//   props: [path_id, link_type],\r\n  data() {\r\n    return {\r\n      markdown_options: {\r\n        navigation: true,\r\n        undo: true, // 上一步\r\n        redo: true, // 下一步\r\n        trash: true, // 清空\r\n        save: true, // 保存（触发events中的save事件）\r\n        subfield: true,\r\n        preview: true,\r\n      },\r\n      markdown_content: '## hello world\\n',\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n#md-editor{\r\n    min-height: 90vh;\r\n    width: 100%;\r\n}\r\n</style>\r\n","import { render } from \"./MarkdownViewer.vue?vue&type=template&id=a9d14518&scoped=true\"\nimport script from \"./MarkdownViewer.vue?vue&type=script&lang=js\"\nexport * from \"./MarkdownViewer.vue?vue&type=script&lang=js\"\n\nimport \"./MarkdownViewer.vue?vue&type=style&index=0&id=a9d14518&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\Github\\\\Shagula\\\\shanotes-ui\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a9d14518\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"main\">\r\n    <el-card id=\"card\">\r\n      <!-- 操作栏 -->\r\n      <template #header>\r\n        <div class=\"operator-bar\">\r\n          <!-- 返回 -->\r\n          <el-button text @click=\"handleFolderBack\">\r\n            <el-icon>\r\n              <ArrowLeft />\r\n            </el-icon>\r\n          </el-button>\r\n          <!-- 打开，添加，删除 -->\r\n          <el-button-group>\r\n            <el-button text @click=\"open_folder\">\r\n              <el-icon>\r\n                <FolderOpened />\r\n              </el-icon>\r\n            </el-button>\r\n            <el-button text @click=\"dialog_vis=true\">\r\n              <el-icon>\r\n                <FolderAdd />\r\n              </el-icon>\r\n            </el-button>\r\n            <el-button type=\"danger\" @click=\"del_link\">\r\n              <el-icon>\r\n                <Delete />\r\n              </el-icon>\r\n            </el-button>\r\n          </el-button-group>\r\n        </div>\r\n      </template>\r\n      <!-- 目录树 -->\r\n      <el-tree v-loading=\"loading\" highlight-current :data=\"folder\" @node-click=\"handleNodeClick\"\r\n        :props=\"{ class: customNodeClass }\"></el-tree>\r\n    </el-card>\r\n    <!-- 创建文件(夹)对话框 -->\r\n    <el-dialog v-model=\"dialog_vis\" title=\"创建新路径\" :before-close=\"handleDiaClose\">\r\n\r\n      <el-form label-width=\"120px\">\r\n        <el-form-item label=\"目录类型\">\r\n          <el-radio-group v-model=\"create_info.type\">\r\n            <el-radio label=\"folder\">文件夹</el-radio>\r\n            <el-radio label=\"file\">文件</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"标题\">\r\n          <el-input v-model=\"create_info.title\" :style=\"{'width':'200px'}\" id=\"path-name-input\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"dialog_vis = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"createLink\">确认</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n    <!-- 删除文件夹对话框 -->\r\n    <el-dialog v-model=\"del_dia_vis\" title=\"删除确认\">\r\n      <span>\r\n        <p style=\"margin-bottom:40px; font-size:30px;color:red\">\r\n          你确定要删除{{selected_folder.title}}吗？删除操作不可撤销<br />\r\n        </p>\r\n      </span>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"dialog_vis = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"confirmDeleteLink\">确认</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { root_path, create_folder, del, create_note, get_children } from \"../../api/notes\";\r\nimport { read_link } from '../../api/notes';\r\n\r\nimport { ElMessage } from 'element-plus'\r\n\r\n\r\nconst FOLDER_TAG = 1, FILE_TAG = 2;\r\n\r\n\r\nexport default {\r\n  async mounted() {\r\n    this.froot = this.folder[0];\r\n    this.selected_folder = this.froot;\r\n    await this.reload_root();\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      create_info: {\r\n        title: '',\r\n        type: ''\r\n      },\r\n      // 选中的folder id \r\n      selected_fid: 0,\r\n      //选中的folder \r\n      selected_folder: null,\r\n      loading: false,\r\n      // 创建对话框\r\n      dialog_vis: false,\r\n      // 删除对话框\r\n      del_dia_vis: false,\r\n\r\n      is_empty_folder: false,\r\n      froot: null,\r\n      folder: [{\r\n        label: '根目录',\r\n        path_id: 0,\r\n        link_type: 1,\r\n        depth: 0,\r\n        children: [],\r\n        parent: 0,\r\n      }]\r\n    }\r\n  },\r\n  methods: {\r\n    customNodeClass(tree, node) {\r\n      let data = node.data;\r\n      if (data.link_type == 1) {\r\n        return `is-folder`;\r\n      }\r\n      return null;\r\n\r\n    },\r\n    // 加载根路径\r\n    async reload_root(path_id = 0) {\r\n      let root_folder;\r\n      if (path_id == 0) {\r\n        this.froot.parent = 0;\r\n        this.froot.path_id = 0;\r\n        this.froot.label = \"根目录\";\r\n        this.froot.depth = 0;\r\n        this.froot.children = [];\r\n\r\n        this.loading = true;\r\n        root_folder = await root_path();\r\n        this.loading = false;\r\n\r\n        this.is_empty_folder = root_folder.meta.status != 200;\r\n        if (!this.is_empty_folder) {\r\n          this.froot.children = await this.process_folder(root_folder.value, 1);\r\n        }\r\n      }\r\n      else {\r\n        let folder_meta = await read_link(path_id);\r\n        if (folder_meta.meta.status != 200)\r\n          return alert(folder_meta.meta.message);\r\n        folder_meta = folder_meta.content;\r\n        console.log(folder_meta);\r\n        this.froot.path_id = folder_meta.id;\r\n        this.froot.label = folder_meta.title;\r\n        this.froot.parent = folder_meta.parent;\r\n        this.froot.depth = 0;\r\n        this.froot.children = [];\r\n\r\n        this.loading = true;\r\n        root_folder = await get_children(path_id);\r\n        this.loading = false;\r\n\r\n        this.is_empty_folder = root_folder == null;\r\n        if (!this.is_empty_folder) {\r\n          this.froot.children = await this.process_folder(root_folder, this.froot.path_id, 1);\r\n        }\r\n      }\r\n\r\n    },\r\n    // 将文件列表转为element tree\r\n    async process_folder(value, parent, depth = 1) {\r\n      let ret = [];\r\n      for (let item of value) {\r\n        let obj = { label: item.title, path_id: item.id, link_type: item.link_type, children: null, parent };\r\n        // 每次最多多读取一层\r\n        if (depth < this.froot.depth + 2 && item.link_type == FOLDER_TAG) {\r\n          let sons = await get_children(item.id);\r\n          if (sons != null)\r\n            obj.children = await this.process_folder(sons, item.id, depth + 1);\r\n        }\r\n        if (item.children != undefined && item.children != null)\r\n          obj.children = item.children;\r\n        ret.push(obj);\r\n      }\r\n      return ret;\r\n    },\r\n\r\n    handleDiaClose() {\r\n      this.dialog_vis = false;\r\n    },\r\n    async handleFolderBack() {\r\n      if (this.froot.path_id != 0) {\r\n        await this.reload_root(this.froot.parent);\r\n      }\r\n    },\r\n    async createLink() {\r\n      if (this.create_info.title.length < 1)\r\n        return alert(\"标题必须长度必须大于1\");\r\n      if (this.create_info.type == \"folder\") {\r\n        let id = await create_folder(this.selected_fid, this.create_info.title);\r\n        if (id.meta.status != 200)\r\n          return alert('创建失败');\r\n\r\n        id = id.id;\r\n        let val = {\r\n          label: this.create_info.title, path_id: id, link_type: 1, children: []\r\n        }\r\n        this.selected_folder.children.push(val);\r\n      }\r\n      else if (this.create_info.type == 'file') {\r\n        let id = await create_note(this.selected_fid, this.create_info.title);\r\n        if (id.meta.status != 200)\r\n          return alert('创建失败');\r\n\r\n        id = id.id;\r\n        let val = {\r\n          label: this.create_info.title, path_id: id, link_type: 2, children: []\r\n        }\r\n        this.selected_folder.children.push(val);\r\n      }\r\n      this.dialog_vis = false;\r\n    },\r\n\r\n    del_link() {\r\n      this.del_dia_vis = true;\r\n    },\r\n    async open_folder() {\r\n      if (this.selected_folder.link_type != FOLDER_TAG)\r\n        ElMessage({\r\n          message: '请打开一个文件夹',\r\n          type: 'error',\r\n        })\r\n      else {\r\n        await this.reload_root(this.selected_fid);\r\n      }\r\n    },\r\n    async confirmDeleteLink() {\r\n      await del(this.selected_fid);\r\n      this.del_dia_vis = false;\r\n\r\n      let iter = (value) => {\r\n        if (value.link_type == FOLDER_TAG && value.children) {\r\n          value.children = value.children.filter((item) => {\r\n            return item.path_id != this.selected_fid;\r\n          })\r\n          for (let item of value.children)\r\n            iter(item);\r\n        }\r\n      }\r\n\r\n      iter(this.froot);\r\n\r\n    },\r\n    // 处理点击事件\r\n    handleNodeClick(tree_node) {\r\n      this.selected_fid = tree_node.path_id;\r\n      this.selected_folder = tree_node;\r\n      this.$emit('click_path', this.selected_folder);\r\n      // 文件类型\r\n      if (tree_node.link_type == '2') {\r\n      }\r\n      //文件夹\r\n      else {\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.main {\r\n  width: 250px;\r\n}\r\n.el-card {\r\n  margin-left: 10px;\r\n  margin-right: 10px;\r\n  min-height: 90vh;\r\n}\r\n\r\n#card {\r\n  .operator-bar {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n}\r\n</style>\r\n<style>\r\n.is-folder > .el-tree-node__content {\r\n  font-weight: bolder;\r\n}\r\n</style>","import { doGet, doPost } from \"@/utils/request\";\r\n// raw\r\nexport async function root_path() {\r\n    return await doGet('/notes/root');\r\n}\r\nexport async function create_folder(parent, title) {\r\n    return await doPost('/notes/create_folder', { parent, title })\r\n}\r\nexport async function create_note(parent, title) {\r\n    return await doPost('/notes/create_note', { parent, title })\r\n}\r\nexport async function del(id) {\r\n    return await doPost('/notes/del_link', { path_id: id });\r\n}\r\nexport async function read_link(id) {\r\n    return await doGet('/notes/read_link', { path_id: id });\r\n}\r\nexport async function update_link(id, content) {\r\n    return await doPost('/notes/update_link', { path_id: id, content });\r\n}\r\n// processed\r\nexport async function get_children(parent) {\r\n    let ret = [];\r\n\r\n    let pinfo = await doGet('/notes/read_link', { path_id: parent });\r\n    if (pinfo.meta.status != 200)\r\n        return [];\r\n    let value = pinfo.content;\r\n    let file_list = JSON.parse(value.content);\r\n    let cinfo = await doGet('/notes/read_child', { path_id: parent });\r\n    if (cinfo.meta.status != 200 || !cinfo.value)\r\n        return [];\r\n    let tab = new Map();\r\n    cinfo = cinfo.value;\r\n\r\n    for (let item of cinfo)\r\n        tab.set(item.id, item);\r\n    for (let item of file_list)\r\n        if (tab.has(item))\r\n            ret.push(tab.get(item));\r\n    return ret;\r\n}\r\n","import { render } from \"./PathTree.vue?vue&type=template&id=3abf8188&scoped=true\"\nimport script from \"./PathTree.vue?vue&type=script&lang=js\"\nexport * from \"./PathTree.vue?vue&type=script&lang=js\"\n\nimport \"./PathTree.vue?vue&type=style&index=0&id=3abf8188&lang=less&scoped=true\"\nimport \"./PathTree.vue?vue&type=style&index=1&id=3abf8188&lang=css\"\n\nimport exportComponent from \"D:\\\\Github\\\\Shagula\\\\shanotes-ui\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3abf8188\"]])\n\nexport default __exports__","import { render } from \"./Notes.vue?vue&type=template&id=698423d1&scoped=true\"\nimport script from \"./Notes.vue?vue&type=script&lang=js\"\nexport * from \"./Notes.vue?vue&type=script&lang=js\"\n\nimport \"./Notes.vue?vue&type=style&index=0&id=698423d1&scoped=true&lang=less\"\n\nimport exportComponent from \"D:\\\\Github\\\\Shagula\\\\shanotes-ui\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-698423d1\"]])\n\nexport default __exports__"],"names":["id","_createElementBlock","_createVNode","_component_PathTree","onClick_path","$options","$data","link_type","_createBlock","_component_mavon_editor","$event","onSave","defaultOpen","subfield","toolbars","navigation","data","markdown_options","undo","redo","trash","save","preview","markdown_content","__exports__","class","style","_createElementVNode","_component_el_card","header","_component_el_button","text","onClick","_component_el_icon","_component_ArrowLeft","_component_el_button_group","_component_FolderOpened","_component_FolderAdd","type","_component_Delete","_component_el_tree","onNodeClick","props","_component_el_dialog","title","footer","_component_el_form","_component_el_form_item","label","_component_el_radio_group","_component_el_radio","_component_el_input","_toDisplayString","_hoisted_9","async","root_path","doGet","create_folder","parent","doPost","create_note","del","path_id","read_link","update_link","content","get_children","ret","pinfo","meta","status","value","file_list","JSON","parse","cinfo","tab","Map","item","set","has","push","get","FOLDER_TAG","this","froot","folder","selected_folder","reload_root","create_info","selected_fid","loading","dialog_vis","del_dia_vis","is_empty_folder","depth","children","methods","customNodeClass","tree","node","root_folder","process_folder","folder_meta","alert","message","console","log","obj","sons","undefined","handleDiaClose","length","val","del_link","ElMessage","iter","filter","handleNodeClick","tree_node","$emit","components","PathTree","MarkdownViewer","cur_path","raw_content","computed","updated","res","saveFile","render"],"sourceRoot":""}